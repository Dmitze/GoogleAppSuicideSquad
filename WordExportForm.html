<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Word-–∑–≤—ñ—Ç—É</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Toastify –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <!-- SortableJS –¥–ª—è Drag&Drop -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
    <style>
      :root {
        --primary: #1a73e8;
        --secondary: #4c9aff;
        --bg-gradient: linear-gradient(135deg, #e3eafc 0%, #f5f7fa 100%);
        --card-bg: #fff;
        --card-shadow: 0 4px 24px rgba(26, 115, 232, 0.08);
        --card-radius: 18px;
        --text-main: #222;
        --text-muted: #6b7a90;
        --accent: #a7bfff;
      }
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
        background: var(--bg-gradient);
        color: var(--text-main);
        min-height: 100vh;
      }
      .container {
        max-width: 900px;
        margin: 40px auto;
        padding: 32px 18px;
        background: var(--card-bg);
        border-radius: var(--card-radius);
        box-shadow: var(--card-shadow);
        display: flex;
        flex-direction: column;
        gap: 24px;
        animation: fadeInUp 0.7s cubic-bezier(.4,1.4,.6,1) forwards;
        opacity: 0;
        transform: translateY(30px);
      }
      @keyframes fadeInUp {
        to { opacity: 1; transform: none; }
      }
      h3 {
        font-size: 2rem;
        font-weight: 700;
        color: var(--primary);
        margin-bottom: 18px;
        letter-spacing: 0.01em;
        text-align: center;
      }
      .block {
        background: #f7f9fc;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(26, 115, 232, 0.04);
        padding: 22px 18px 18px 18px;
        margin-bottom: 0;
        display: flex;
        flex-direction: column;
        gap: 10px;
        transition: box-shadow 0.3s, transform 0.3s;
      }
      .block:focus-within, .block:hover {
        box-shadow: 0 6px 24px rgba(26, 115, 232, 0.10);
        transform: scale(1.01);
      }
      label {
        font-weight: 500;
        color: var(--primary);
        margin-bottom: 4px;
        font-size: 1.05em;
      }
      input[type="text"], input[type="date"], input[type="email"], input[type="color"], select, textarea {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #c7d0e1;
        border-radius: 8px;
        font-size: 1em;
        background: #fff;
        margin-bottom: 4px;
        transition: border 0.2s, box-shadow 0.2s;
      }
      input:focus, select:focus, textarea:focus {
        border: 1.5px solid var(--primary);
        box-shadow: 0 2px 8px rgba(26, 115, 232, 0.08);
        outline: none;
      }
      textarea {
        resize: vertical;
        min-height: 60px;
      }
      .btn-main, .btn-add, .btn-remove, .btn-preview, .btn-update-sheets, .export-btn {
        padding: 12px 24px;
        font-size: 1.08em;
        background: linear-gradient(145deg, var(--primary), var(--secondary));
        color: white;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(.4,1.4,.6,1);
        box-shadow: 0 4px 12px rgba(26, 115, 232, 0.13);
        font-weight: 500;
        letter-spacing: 0.01em;
        margin-right: 10px;
      }
      .btn-main:hover, .btn-add:hover, .btn-remove:hover, .btn-preview:hover, .btn-update-sheets:hover, .export-btn:hover {
        transform: translateY(-2px) scale(1.03);
        box-shadow: 0 8px 24px rgba(26, 115, 232, 0.18);
        background: linear-gradient(145deg, #4c9aff, #1a73e8);
      }
      .btn-main:active, .btn-add:active, .btn-remove:active, .btn-preview:active, .btn-update-sheets:active, .export-btn:active {
        transform: translateY(0) scale(1.01);
      }
      .export-group {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        justify-content: center;
        margin-bottom: 20px;
      }
      .progress-bar-background {
        width: 100%;
        background: #e0e0e0;
        border-radius: 8px;
        margin-top: 25px;
        height: 18px;
        position: relative;
        overflow: hidden;
        display: none;
      }
      .progress-bar {
        background: linear-gradient(90deg, #4a90e2, #2ecc71, #f39c12, #e74c3c, #4a90e2);
        background-size: 200% 100%;
        animation: progressmove 1s linear infinite;
        height: 100%;
        width: 100%;
        border-radius: 8px;
        transition: width 0.3s;
      }
      @keyframes progressmove {
        0% {background-position: 0% 50%;}
        100% {background-position: 100% 50%;}
      }
      @media (max-width: 700px) {
        .container {
          padding: 8px 2px;
        }
        .block {
          padding: 12px 6px 10px 6px;
        }
        .export-group {
          gap: 6px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h3>üìä –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Word-–∑–≤—ñ—Ç—É</h3>

      <form id="reportForm" autocomplete="off" onsubmit="exportReport();return false;">
      <div class="block">
        <label for="boss">–ù–∞—á–∞–ª—å–Ω–∏–∫:</label>
        <input id="boss" list="boss_list" type="text" placeholder="–Ü–≤–∞–Ω–æ–≤ –Ü.–Ü." autocomplete="off">
        <datalist id="boss_list"></datalist>
      </div>

      <div class="block">
        <label for="date">–î–∞—Ç–∞:</label>
        <input id="date" type="date">
      </div>

      <div class="block">
        <label for="order">–ù–∞–∫–∞–∑:</label>
        <input id="order" type="text" placeholder="‚Ññ123 –≤—ñ–¥ 01.01.2025" pattern="‚Ññ\d+ –≤—ñ–¥ \d{2}\.\d{2}\.\d{4}">
        <small>–§–æ—Ä–º–∞—Ç: ‚Ññ123 –≤—ñ–¥ 01.01.2025</small>
      </div>

      <div class="block">
        <label for="title">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∑–≤—ñ—Ç—É:</label>
        <input id="title" type="text" placeholder="–ü—ñ–¥—Å—É–º–∫–æ–≤–∏–π –∑–≤—ñ—Ç –∑–∞ –∫–≤–∞—Ä—Ç–∞–ª">
      </div>

      <div class="block">
        <label for="description">–û–ø–∏—Å (–ø–æ—è—Å–Ω–µ–Ω–Ω—è):</label>
        <textarea id="description" placeholder="–î–æ–¥–∞–π—Ç–µ –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç –¥–æ –∑–≤—ñ—Ç—É..."></textarea>
      </div>

      <div class="block">
        <label for="email">Email –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ):</label>
        <input id="email" type="email" placeholder="user@email.com">
      </div>
      <div class="block">
        <button type="button" class="btn-main" onclick="useSelectedRange()">üìã –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –≤–∏–¥—ñ–ª–µ–Ω–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω</button>
      </div>

      <div class="block" id="tablesBlock">
        <label>–¢–∞–±–ª–∏—Ü—ñ (–ª–∏—Å—Ç + –¥—ñ–∞–ø–∞–∑–æ–Ω):</label>
        <div class="export-group">
          <button type="button" class="btn-update-sheets" onclick="updateSheetNames()">üîÑ –û–Ω–æ–≤–∏—Ç–∏ –ª–∏—Å—Ç–∏</button>
        </div>
        <div id="tablesList"></div>
        <button type="button" onclick="addTableRow()" class="btn-add">+ –î–æ–¥–∞—Ç–∏ —Ç–∞–±–ª–∏—Ü—é</button>
      </div>

      <div class="block">
        <label><b>–û–ø—Ü—ñ—ó –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è:</b></label>
        <div style="display:flex;gap:16px;flex-wrap:wrap;align-items:center;">
          <div>
            <label for="tableBgColor">–ö–æ–ª—ñ—Ä —Ñ–æ–Ω—É —Ç–∞–±–ª–∏—Ü—ñ:</label>
            <input type="color" id="tableBgColor" value="#ffffff">
          </div>
          <div>
            <label for="tableTextColor">–ö–æ–ª—ñ—Ä —Ç–µ–∫—Å—Ç—É:</label>
            <input type="color" id="tableTextColor" value="#222222">
          </div>
          <div>
            <label for="tableFont">–®—Ä–∏—Ñ—Ç:</label>
            <select id="tableFont">
              <option value="Arial">Arial</option>
              <option value="Times New Roman">Times New Roman</option>
              <option value="Calibri">Calibri</option>
              <option value="Roboto">Roboto</option>
              <option value="Verdana">Verdana</option>
            </select>
          </div>
          <div>
            <label for="logoUpload">–õ–æ–≥–æ—Ç–∏–ø (PNG/JPG):</label>
            <input type="file" id="logoUpload" accept="image/png,image/jpeg">
          </div>
          <div>
            <label for="headerText">–¢–µ–∫—Å—Ç —à–∞–ø–∫–∏:</label>
            <input type="text" id="headerText" placeholder="–í–∞—à–∞ —à–∞–ø–∫–∞">
          </div>
        </div>
      </div>

      <div class="export-group">
        <button type="button" class="btn-main export-btn" onclick="exportReport('word')">üìÑ –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ Word</button>
        <button type="button" class="btn-main export-btn" onclick="exportReport('pdf')">üîΩ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ PDF</button>
        <button type="button" class="btn-main export-btn" onclick="exportReport('excel')">üìä –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ Excel</button>
      </div>
      <div class="progress-bar-background" id="progressBarBg">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div id="status"></div>
      </form>
    </div>

    <script>
      let sheetNames = [];

      // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–æ—Ä–º—ã –≤ localStorage
      const FORM_STORAGE_KEY = "word_export_form_state_v2";
      function saveFormState() {
        let state = {
          boss: document.getElementById('boss').value,
          date: document.getElementById('date').value,
          order: document.getElementById('order').value,
          title: document.getElementById('title').value,
          description: document.getElementById('description').value,
          email: document.getElementById('email').value,
          tables: Array.from(document.querySelectorAll('.tableRow')).map(row => ({
            sheet: row.querySelector('.sheetSel').value,
            range: row.querySelector('.rangeInput').value
          })),
          tableBgColor: document.getElementById('tableBgColor').value,
          tableTextColor: document.getElementById('tableTextColor').value,
          tableFont: document.getElementById('tableFont').value,
          headerText: document.getElementById('headerText').value,
          logoBase64: '' // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –ª–æ–≥–æ—Ç–∏–ø
        };
        localStorage.setItem(FORM_STORAGE_KEY, JSON.stringify(state));
      }
      function loadFormState() {
        let s = localStorage.getItem(FORM_STORAGE_KEY);
        if (!s) return;
        try {
          let state = JSON.parse(s);
          document.getElementById('boss').value = state.boss || "";
          document.getElementById('date').value = state.date || "";
          document.getElementById('order').value = state.order || "";
          document.getElementById('title').value = state.title || "";
          document.getElementById('description').value = state.description || "";
          document.getElementById('email').value = state.email || "";
          document.getElementById('tablesList').innerHTML = "";
          if (Array.isArray(state.tables) && state.tables.length) {
            state.tables.forEach(t => addTableRow(t.sheet, t.range));
          }
          document.getElementById('tableBgColor').value = state.tableBgColor || "#ffffff";
          document.getElementById('tableTextColor').value = state.tableTextColor || "#222222";
          document.getElementById('tableFont').value = state.tableFont || "Arial";
          document.getElementById('headerText').value = state.headerText || "";
          if (state.logoBase64) {
            document.getElementById('logoUpload').files = new File([state.logoBase64], "logo.png", { type: "image/png" });
          }
        } catch(e){}
      }
      function clearFormState() {
        localStorage.removeItem(FORM_STORAGE_KEY);
      }
      setInterval(saveFormState, 700);

      // Drag & Drop reorder
      window.addEventListener('DOMContentLoaded', function() {
        new Sortable(document.getElementById('tablesList'), {
          animation: 150,
          handle: '.tableRow',
          ghostClass: 'sortable-ghost',
          onEnd: saveFormState
        });
      });

      function addTableRow(sheet='', range='') {
        const div = document.createElement('div');
        div.className = 'tableRow';
        div.innerHTML = `
          <span style="cursor:grab;user-select:none;" title="–ü–µ—Ä–µ—Ç—è–≥–Ω—ñ—Ç—å">&#x2630;</span>
          <select class="sheetSel">${sheetNames.map(n => `<option value="${n}" ${n===sheet?'selected':''}>${n}</option>`).join('')}</select>
          <input type="text" class="rangeInput" value="${range||'A1:B2'}" placeholder="A1:B2">
          <button type="button" class="btn-remove" title="–í–∏–¥–∞–ª–∏—Ç–∏">&#128465;</button>
          <button type="button" class="btn-preview" title="–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏">üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–¥</button>
          <div class="previewArea"></div>
        `;
        document.getElementById('tablesList').appendChild(div);

        // Toggle preview on click
        div.querySelector('.btn-preview').addEventListener('click', () => {
          const previewArea = div.querySelector('.previewArea');
          if (previewArea.style.display === 'block') {
            previewArea.style.display = 'none';
          } else {
            showPreview(div.querySelector('.btn-preview'));
            previewArea.style.display = 'block';
          }
        });

        // Remove row on click
        div.querySelector('.btn-remove').addEventListener('click', () => {
          div.remove();
          saveFormState();
        });

        // Save state on change
        div.querySelector('.sheetSel').addEventListener('change', saveFormState);
        div.querySelector('.rangeInput').addEventListener('input', saveFormState);
      }

      function showPreview(btn) {
        const row = btn.parentElement;
        const sheet = row.querySelector('.sheetSel').value;
        const range = row.querySelector('.rangeInput').value;
        const previewArea = row.querySelector('.previewArea');
        previewArea.innerHTML = '‚è≥ –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é...';

        google.script.run.withSuccessHandler(data => {
          if (!data.length) {
            previewArea.innerHTML = '<i>–î–∞–Ω—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ</i>';
            return;
          }
          let html = '<table class="preview"><tr>' +
            data[0].map(h => `<th>${h}</th>`).join('') + '</tr>';
          for (let i=1; i<data.length; ++i)
            html += '<tr>' + data[i].map(c => `<td>${c}</td>`).join('') + '</tr>';
          html += '</table>';
          previewArea.innerHTML = html;
        }).getPreviewData(sheet, range);
      }

      // –ú–∞—Å–∫–∞ –¥–ª—è –Ω–æ–º–µ—Ä–∞ –ø—Ä–∏–∫–∞–∑–∞
      document.addEventListener('DOMContentLoaded', function() {
        const orderInput = document.getElementById('order');
        orderInput.addEventListener('input', function() {
          this.setCustomValidity(this.value.match(/^‚Ññ\d+ –≤—ñ–¥ \d{2}\.\d{2}\.\d{4}$/) ? '' : '–§–æ—Ä–º–∞—Ç: ‚Ññ123 –≤—ñ–¥ 01.01.2025');
        });
      });

      // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏—Å—Ç–æ–≤
      function updateSheetNames() {
        google.script.run.withSuccessHandler(function(names){
          sheetNames = names;
          // –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏
          Array.from(document.querySelectorAll('.sheetSel')).forEach(sel => {
            let curr = sel.value;
            sel.innerHTML = sheetNames.map(n => `<option value="${n}">${n}</option>`).join('');
            sel.value = curr || sheetNames[0];
          });
          Toastify({text:"‚úÖ –õ–∏—Å—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–æ!", backgroundColor: "#2ecc71"}).showToast();
        }).getSheetNames();
      }

      // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
      function showProgressBar(show=true) {
        const bg = document.getElementById('progressBarBg');
        bg.style.display = show ? 'block' : 'none';
      }

      // –≠–∫—Å–ø–æ—Ä—Ç Word/PDF/Excel
      function exportReport(format='word') {
        // –£–ë–†–ê–ù–ê –≤—Å—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è!
        const header = {
          boss: document.getElementById('boss').value,
          date: document.getElementById('date').value,
          order: document.getElementById('order').value,
        };
        const title = document.getElementById('title').value;
        const description = document.getElementById('description').value;
        const email = document.getElementById('email') ? document.getElementById('email').value : '';
        const tables = Array.from(document.querySelectorAll('.tableRow')).map(row => ({
          sheet: row.querySelector('.sheetSel').value,
          range: row.querySelector('.rangeInput').value,
        }));

        // –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∏ —à–∞–±–ª–æ–Ω
        const styleOptions = {
          tableBgColor: document.getElementById('tableBgColor').value,
          tableTextColor: document.getElementById('tableTextColor').value,
          tableFont: document.getElementById('tableFont').value,
          headerText: document.getElementById('headerText').value,
          logoBase64: ''
        };
        // –õ–æ–≥–æ—Ç–∏–ø (–µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω)
        const logoInput = document.getElementById('logoUpload');
        if (logoInput && logoInput.files && logoInput.files[0]) {
          const reader = new FileReader();
          reader.onload = function(e) {
            styleOptions.logoBase64 = e.target.result.split(',')[1];
            sendExport();
          };
          reader.readAsDataURL(logoInput.files[0]);
          return;
        }
        sendExport();
        function sendExport() {
          document.getElementById('status').innerHTML = '';
          showProgressBar(true);

          let formData = {
            header: header,
            title: title,
            description: description,
            tables: tables,
            email: email,
            style: styleOptions
          };

          let successHandler = function(url) {
            showProgressBar(false);
            let txt = '';
            if (format === 'word') txt = `<b>‚úÖ Word-—Ñ–∞–π–ª —Å—Ç–≤–æ—Ä–µ–Ω–æ!</b> <a href="${url}" target="_blank" style="color:#4a90e2;">ÔøΩÔøΩ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</a>`;
            else if (format === 'pdf') txt = `<b>‚úÖ PDF-—Ñ–∞–π–ª —Å—Ç–≤–æ—Ä–µ–Ω–æ!</b> <a href="${url}" target="_blank" style="color:#4a90e2;">üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</a>`;
            else if (format === 'excel') txt = `<b>‚úÖ Excel-—Ñ–∞–π–ª —Å—Ç–≤–æ—Ä–µ–Ω–æ!</b> <a href="${url}" target="_blank" style="color:#4a90e2;">üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</a>`;
            document.getElementById('status').innerHTML = txt;
            Toastify({
              text: "‚úîÔ∏è –§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–æ!",
              duration: 3000,
              gravity: "top",
              position: "center",
              backgroundColor: "#2ecc71"
            }).showToast();
            clearFormState();
            if(email) {
              google.script.run.sendFileByEmail(email, url, (title||'ExportedSheet') + '.' + format, '–í–∞—à —Ñ–∞–π–ª —É –≤–∫–ª–∞–¥–µ–Ω–Ω—ñ.');
            }
          };
          let failHandler = function(e) {
            showProgressBar(false);
            document.getElementById('status').innerHTML =
              `<span style="color:red;">‚ùå –ü–æ–º–∏–ª–∫–∞: ${e.message || e}</span>`;
            Toastify({
              text: `‚ùå –ü–æ–º–∏–ª–∫–∞: ${e.message || e}`,
              duration: 5000,
              gravity: "top",
              position: "center",
              backgroundColor: "#e74c3c"
            }).showToast();
          };

          if (format === 'word') {
            google.script.run.withSuccessHandler(successHandler).withFailureHandler(failHandler)
              .generateWordReport(formData);
          } else if (format === 'pdf') {
            google.script.run.withSuccessHandler(successHandler).withFailureHandler(failHandler)
              .generatePdfReport(formData);
          } else if (format === 'excel') {
            google.script.run.withSuccessHandler(successHandler).withFailureHandler(failHandler)
              .generateExcelReport(formData);
          }
        }
      }

      function useSelectedRange() {
        google.script.run.withSuccessHandler(function(a1){
          if(a1) {
            // –ù–∞–π—Ç–∏ –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∏ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
            let rangeInput = document.querySelector('.rangeInput') || document.getElementById('range');
            if(rangeInput) rangeInput.value = a1;
          }
        }).getActiveRangeA1();
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –ø–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç—ã –∏ –¥–æ–±–∞–≤–∏—Ç—å –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
      google.script.run.withSuccessHandler(function(names){
        sheetNames = names;
        loadFormState();
        if (!document.querySelector('.tableRow') && sheetNames.length) addTableRow(sheetNames[0], 'A1:B2');
      }).getSheetNames();

      // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞ (datalist) –∏–∑ Google Sheets
      google.script.run.withSuccessHandler(function(arr){
        let dl = document.getElementById('boss_list');
        dl.innerHTML = "";
        arr.forEach(name => {
          let opt = document.createElement('option');
          opt.value = name;
          dl.appendChild(opt);
        });
      }).getBossesList();
    </script>
  </body>
</html>
