<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body {
      font-family: Arial;
      padding: 20px;
    }
    input[type="number"], input[type="text"] {
      width: 100%;
      padding: 5px;
      margin: 5px 0;
    }
    select, button {
      width: 100%;
      padding: 8px;
      margin: 10px 0;
      font-size: 14px;
    }
    .section {
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 5px;
    }
    h3 {
      margin-top: 0;
    }
  </style>
</head>
<body>

<!-- –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ä—è–¥–∫—ñ–≤ —ñ —Å—Ç–æ–≤–ø—Ü—ñ–≤ -->
<div class="section">
  <h3>üìè –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è</h3>
  <p>–í–∏—Å–æ—Ç–∞ —Ä—è–¥–∫—ñ–≤ (px):</p>
  <input type="number" id="rowHeightInput" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 21" />

  <p>–®–∏—Ä–∏–Ω–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ (px):</p>
  <input type="number" id="colWidthInput" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 120" />

  <button onclick="applyFormatting()">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
</div>

<!-- –¢–µ–∫—Å—Ç–æ–≤—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è -->
<div class="section">
  <h3>üî§ –¢–µ–∫—Å—Ç–æ–≤—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è</h3>
  <p>–¢–µ–∫—Å—Ç:</p>
  <input type="text" id="inputText" placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç" />

  <p>–í–∏–Ω—è—Ç–∫–∏ / –∑–∞–º—ñ–Ω–∏:</p>
  <input type="text" id="exceptionsInput" placeholder="–°–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∫–æ–º—É –∞–±–æ word‚Üí–∑–∞–º—ñ–Ω–∞" />

  <p>–î—ñ—è:</p>
  <select id="actionSelect">
    <option value="lowercase">–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ –Ω–∏–∂–Ω—ñ–π —Ä–µ–≥—ñ—Å—Ç—Ä</option>
    <option value="remove">–í–∏–¥–∞–ª–∏—Ç–∏ —Å–ª–æ–≤–∞</option>
    <option value="replace">–ó–∞–º—ñ–Ω–∏—Ç–∏ —Å–ª–æ–≤–∞</option>
    <option value="count">–ü–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–ª–æ–≤–∞</option>
    <option value="reverse">–ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∏ —Ç–µ–∫—Å—Ç</option>
    <option value="mask">–ó–∞–º–∞—Å–∫—É–≤–∞—Ç–∏ –ø–æ—á–∞—Ç–æ–∫</option>
  </select>

  <button onclick="applyTextAction()">–í–∏–∫–æ–Ω–∞—Ç–∏</button>

  <p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong></p>
  <textarea id="resultText" style="width:100%; height:100px;" readonly></textarea>
</div>

<script>
  // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
  function applyFormatting() {
    const rowInput = document.getElementById("rowHeightInput");
    const colInput = document.getElementById("colWidthInput");
    const rowHeight = parseInt(rowInput.value);
    const colWidth = parseInt(colInput.value);

    if ((rowInput.value && (isNaN(rowHeight) || rowHeight <= 0)) ||
        (colInput.value && (isNaN(colWidth) || colWidth <= 0))) {
      alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ —á–∏—Å–ª–∞ –±—ñ–ª—å—à–µ –Ω—É–ª—è.");
      return;
    }

    if (rowHeight > 0) {
      google.script.run.setUniformRowHeight(rowHeight);
    }

    if (colWidth > 0) {
      google.script.run.setUniformColumnWidth(colWidth);
    }
  }

  // –¢–µ–∫—Å—Ç–æ–≤—ñ –¥—ñ—ó
  function applyTextAction() {
    const inputText = document.getElementById("inputText").value;
    const exceptions = document.getElementById("exceptionsInput").value;
    const action = document.getElementById("actionSelect").value;
    const resultBox = document.getElementById("resultText");

    if (!inputText) {
      alert("–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è –æ–±—Ä–æ–±–∫–∏.");
      return;
    }

    switch (action) {
      case "lowercase":
        google.script.run
          .withSuccessHandler(result => resultBox.value = result)
          .TOLOWERCASEEXCEPT(inputText, exceptions);
        break;

      case "remove":
        google.script.run
          .withSuccessHandler(result => resultBox.value = result)
          .REMOVEWORDS(inputText, exceptions);
        break;

      case "replace":
        google.script.run
          .withSuccessHandler(result => resultBox.value = result)
          .REPLACEWORDS(inputText, exceptions);
        break;

      case "count":
        resultBox.value = google.script.run.COUNTWORDS(inputText);
        break;

      case "reverse":
        google.script.run
          .withSuccessHandler(result => resultBox.value = result)
          .REVERSETEXT(inputText);
        break;

      case "mask":
        const maskCount = prompt("–°–∫—ñ–ª—å–∫–∏ —Å–∏–º–≤–æ–ª—ñ–≤ –∑–∞–º–∞—Å–∫—É–≤–∞—Ç–∏?", "4");
        if (maskCount && !isNaN(maskCount) && maskCount > 0) {
          google.script.run
            .withSuccessHandler(result => resultBox.value = result)
            .MASKTEXT(inputText, maskCount);
        }
        break;
    }
  }
</script>

</body>
</html>
