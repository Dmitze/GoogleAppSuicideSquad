<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ Google Sheets</title>
  <style>
    :root {
      --primary: #1a73e8;
      --secondary: #4c9aff;
      --bg-gradient: linear-gradient(135deg, #e3eafc 0%, #f5f7fa 100%);
      --card-bg: #fff;
      --card-shadow: 0 4px 24px rgba(26, 115, 232, 0.08);
      --card-radius: 18px;
      --text-main: #222;
      --text-muted: #6b7a90;
      --accent: #a7bfff;
    }
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      background: var(--bg-gradient);
      color: var(--text-main);
      min-height: 100vh;
    }
    .section {
      background: var(--card-bg);
      border-radius: var(--card-radius);
      box-shadow: var(--card-shadow);
      padding: 24px 18px 18px 18px;
      margin-bottom: 22px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      animation: fadeInUp 0.7s cubic-bezier(.4,1.4,.6,1) forwards;
      opacity: 0;
      transform: translateY(30px);
    }
    .section:nth-child(2) { animation-delay: 0.1s; }
    .section:nth-child(3) { animation-delay: 0.2s; }
    @keyframes fadeInUp {
      to { opacity: 1; transform: none; }
    }
    h3 {
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 10px;
      letter-spacing: 0.01em;
    }
    label, p {
      font-weight: 500;
      color: var(--primary);
      margin-bottom: 4px;
      font-size: 1.05em;
    }
    input[type="number"], input[type="text"], select, button, textarea {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #c7d0e1;
      border-radius: 8px;
      font-size: 1em;
      background: #fff;
      margin-bottom: 4px;
      transition: border 0.2s, box-shadow 0.2s;
    }
    input:focus, select:focus, textarea:focus {
      border: 1.5px solid var(--primary);
      box-shadow: 0 2px 8px rgba(26, 115, 232, 0.08);
      outline: none;
    }
    button {
      padding: 12px 24px;
      font-size: 1.08em;
      background: linear-gradient(145deg, var(--primary), var(--secondary));
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(.4,1.4,.6,1);
      box-shadow: 0 4px 12px rgba(26, 115, 232, 0.13);
      font-weight: 500;
      letter-spacing: 0.01em;
      margin-top: 8px;
    }
    button:hover {
      transform: translateY(-2px) scale(1.03);
      box-shadow: 0 8px 24px rgba(26, 115, 232, 0.18);
      background: linear-gradient(145deg, #4c9aff, #1a73e8);
    }
    button:active {
      transform: translateY(0) scale(1.01);
    }
    textarea {
      resize: vertical;
      min-height: 60px;
    }
    @media (max-width: 700px) {
      .section {
        padding: 12px 6px 10px 6px;
      }
    }
  </style>
</head>
<body>

<!-- –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ä—è–¥–∫—ñ–≤ —ñ —Å—Ç–æ–≤–ø—Ü—ñ–≤ -->
<div class="section">
  <h3>üìè –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è</h3>
  <p>–í–∏—Å–æ—Ç–∞ —Ä—è–¥–∫—ñ–≤ (px):</p>
  <input type="number" id="rowHeightInput" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 21" />

  <p>–®–∏—Ä–∏–Ω–∞ —Å—Ç–æ–≤–ø—Ü—ñ–≤ (px):</p>
  <input type="number" id="colWidthInput" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: 120" />

  <button onclick="applyFormatting()">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
</div>

<!-- –¢–µ–∫—Å—Ç–æ–≤—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è -->
<div class="section">
  <h3>üî§ –¢–µ–∫—Å—Ç–æ–≤—ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è</h3>
  <p>–¢–µ–∫—Å—Ç:</p>
  <input type="text" id="inputText" placeholder="–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç" />

  <p>–í–∏–Ω—è—Ç–∫–∏ / –∑–∞–º—ñ–Ω–∏:</p>
  <input type="text" id="exceptionsInput" placeholder="–°–ª–æ–≤–∞ —á–µ—Ä–µ–∑ –∫–æ–º—É –∞–±–æ word‚Üí–∑–∞–º—ñ–Ω–∞" />

  <p>–î—ñ—è:</p>
  <select id="actionSelect">
    <option value="lowercase">–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ –Ω–∏–∂–Ω—ñ–π —Ä–µ–≥—ñ—Å—Ç—Ä</option>
    <option value="remove">–í–∏–¥–∞–ª–∏—Ç–∏ —Å–ª–æ–≤–∞</option>
    <option value="replace">–ó–∞–º—ñ–Ω–∏—Ç–∏ —Å–ª–æ–≤–∞</option>
    <option value="count">–ü–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–ª–æ–≤–∞</option>
    <option value="reverse">–ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∏ —Ç–µ–∫—Å—Ç</option>
    <option value="mask">–ó–∞–º–∞—Å–∫—É–≤–∞—Ç–∏ –ø–æ—á–∞—Ç–æ–∫</option>
  </select>

  <button onclick="applyTextAction()">–í–∏–∫–æ–Ω–∞—Ç–∏</button>

  <p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong></p>
  <textarea id="resultText" style="width:100%; height:100px;" readonly></textarea>
</div>

<script>
  // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
  function applyFormatting() {
    const rowInput = document.getElementById("rowHeightInput");
    const colInput = document.getElementById("colWidthInput");
    const rowHeight = parseInt(rowInput.value);
    const colWidth = parseInt(colInput.value);

    if ((rowInput.value && (isNaN(rowHeight) || rowHeight <= 0)) ||
        (colInput.value && (isNaN(colWidth) || colWidth <= 0))) {
      alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—ñ —á–∏—Å–ª–∞ –±—ñ–ª—å—à–µ –Ω—É–ª—è.");
      return;
    }

    if (rowHeight > 0) {
      google.script.run.setUniformRowHeight(rowHeight);
    }

    if (colWidth > 0) {
      google.script.run.setUniformColumnWidth(colWidth);
    }
  }

  // –¢–µ–∫—Å—Ç–æ–≤—ñ –¥—ñ—ó
  function applyTextAction() {
    const inputText = document.getElementById("inputText").value;
    const exceptions = document.getElementById("exceptionsInput").value;
    const action = document.getElementById("actionSelect").value;
    const resultBox = document.getElementById("resultText");

    if (!inputText) {
      alert("–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è –æ–±—Ä–æ–±–∫–∏.");
      return;
    }

    switch (action) {
      case "lowercase":
        google.script.run
          .withSuccessHandler(result => resultBox.value = result)
          .TOLOWERCASEEXCEPT(inputText, exceptions);
        break;

      case "remove":
        google.script.run
          .withSuccessHandler(result => resultBox.value = result)
          .REMOVEWORDS(inputText, exceptions);
        break;

      case "replace":
        google.script.run
          .withSuccessHandler(result => resultBox.value = result)
          .REPLACEWORDS(inputText, exceptions);
        break;

      case "count":
        resultBox.value = google.script.run.COUNTWORDS(inputText);
        break;

      case "reverse":
        google.script.run
          .withSuccessHandler(result => resultBox.value = result)
          .REVERSETEXT(inputText);
        break;

      case "mask":
        const maskCount = prompt("–°–∫—ñ–ª—å–∫–∏ —Å–∏–º–≤–æ–ª—ñ–≤ –∑–∞–º–∞—Å–∫—É–≤–∞—Ç–∏?", "4");
        if (maskCount && !isNaN(maskCount) && maskCount > 0) {
          google.script.run
            .withSuccessHandler(result => resultBox.value = result)
            .MASKTEXT(inputText, maskCount);
        }
        break;
    }
  }
</script>

</body>
</html>
